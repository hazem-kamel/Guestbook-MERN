import*as e from"react";import{isValidElement as r,createContext as t,useContext as n,createElement as c,useState as s,useRef as u,useEffect as i,cloneElement as a,Fragment as o}from"react";var l=e=>void 0===e,f=e=>null===e||l(e),d=e=>Array.isArray(e);const g=e=>"object"==typeof e;var m=e=>!f(e)&&!d(e)&&g(e),h=e=>m(e)&&e.nodeType===Node.ELEMENT_NODE;const b={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit"},v="undefined",p={BLUR:"blur",CHANGE:"change",INPUT:"input"},O="max",y="min",j="maxLength",S="minLength",R="pattern",V="required",E="validate",x=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,w=/^\w*$/,B=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g;var N=e=>!d(e)&&(w.test(e)||!x.test(e)),F=e=>{const r=[];return e.replace(B,(e,t,n,c)=>{r.push(n?c.replace(C,"$1"):t||e)}),r};function k(e,r,t){let n=-1;const c=N(r)?[r]:F(r),s=c.length,u=s-1;for(;++n<s;){const r=c[n];let s=t;if(n!==u){const t=e[r];s=m(t)||d(t)?t:isNaN(c[n+1])?{}:[]}e[r]=s,e=e[r]}return e}var L=e=>Object.entries(e).reduce((e,[r,t])=>N(r)?Object.assign(Object.assign({},e),{[r]:t}):(k(e,r,t),e),{}),$=(e,r,t)=>{const n=r.split(/[,[\].]+?/).filter(Boolean).reduce((e,r)=>f(e)?e:e[r],e);return l(n)||n===e?e[r]||t:n},A=(e,r)=>{for(const t in e)if($(r,t)){const r=e[t];if(r){if(r.ref.focus){r.ref.focus();break}if(r.options){r.options[0].ref.focus();break}}}},D=(e,r)=>{h(e)&&e.removeEventListener&&(e.removeEventListener(p.INPUT,r),e.removeEventListener(p.CHANGE,r),e.removeEventListener(p.BLUR,r))},M=e=>!!e&&"radio"===e.type,W=e=>!!e&&"checkbox"===e.type;function P(e){return!e||e instanceof HTMLElement&&e.nodeType!==Node.DOCUMENT_NODE&&P(e.parentNode)}var T=e=>m(e)&&!Object.keys(e).length;function U(e){return d(e)?e:F(e)}function I(e,r){return 1==r.length?e:function(e,r){const t=N(r)?[r]:U(r),n=r.length;let c=0;for(;c<n;)e=l(e)?c++:e[t[c++]];return c==n?e:void 0}(e,function(e,r,t){let n=-1,c=e.length;r<0&&(r=-r>c?0:c+r),(t=t>c?c:t)<0&&(t+=c),c=r>t?0:t-r;const s=Array(c);for(;++n<c;)s[n]=e[n+r];return s}(r,0,-1))}function z(e,r){return r.forEach(r=>{!function(e,r){const t=N(r)?[r]:U(r),n=I(e,t),c=t[t.length-1],s=!(null!=n)||delete n[c];let u=void 0;for(let r=0;r<t.slice(0,-1).length;r++){let n=-1,c=void 0;const s=t.slice(0,-(r+1)),i=s.length-1;for(r>0&&(u=e);++n<s.length;){const r=s[n];c=c?c[r]:e[r],i===n&&(m(c)&&T(c)?u?delete u[r]:delete e[r]:d(c)&&!c.filter(e=>m(e)&&!T(e)).length&&u&&delete u[r]),u=c}}}(e,r)}),e}const H={isValid:!1,value:""};var G=e=>d(e)?e.filter(Boolean).reduce((e,{ref:{checked:r,value:t}})=>r?{isValid:!0,value:t}:e,H):H,_=e=>[...e].filter(({selected:e})=>e).map(({value:e})=>e),q=e=>!!e&&"file"===e.type,J=e=>!!e&&"select-multiple"===e.type,K=e=>""===e;const Q={value:!1,isValid:!1},X={value:!0,isValid:!0};var Y=e=>{if(d(e)){if(e.length>1){const r=e.filter(({ref:{checked:e}})=>e).map(({ref:{value:e}})=>e);return{value:r,isValid:!!r.length}}const{checked:r,value:t,attributes:n}=e[0].ref;return r?n&&!l(n.value)?l(t)||K(t)?X:{value:t,isValid:!0}:X:Q}return Q};function Z(e,r){const{name:t,value:n}=r,c=e[t];return q(r)?r.files:M(r)?c?G(c.options).value:"":J(r)?_(r.options):W(r)?!!c&&Y(c.options).value:n}var ee=e=>"string"==typeof e,re=(e,r)=>{const t={},n=ee(r),c=d(r),s=r&&r.nest;for(const u in e)(l(r)||s||n&&u.startsWith(r)||c&&r.find(e=>u.startsWith(e)))&&(t[u]=Z(e,e[u].ref));return t},te=(e,{type:r,types:t,message:n})=>m(e)&&e.type===r&&e.message===n&&((e={},r={})=>{const t=Object.entries(e),n=Object.keys(r);return t.length===n.length&&t.reduce((e,[t,n])=>!!e&&r[t]&&r[t]===n,!0)})(e.types,t);var ne=e=>e instanceof RegExp,ce=e=>{return(e=>m(e)&&!ne(e))(e)?e:{value:e,message:""}},se=e=>"function"==typeof e,ue=e=>"boolean"==typeof e,ie=e=>ee(e)||m(e)&&r(e);function ae(e,r,t="validate"){if(ie(e)||ue(e)&&!e){return{type:t,message:ie(e)?e:"",ref:r}}}var oe=(e,r,t,n,c)=>{if(!r)return{};const s=t[e];return Object.assign(Object.assign({},s),{types:Object.assign(Object.assign({},s&&s.types?s.types:{}),{[n]:c||!0})})},le=async(e,r,{ref:t,ref:{type:n,value:c,name:s},options:u,required:i,maxLength:a,minLength:o,min:l,max:d,pattern:g,validate:h})=>{const b=e.current,v={},p=M(t),x=W(t),w=p||x,B=K(c),C=oe.bind(null,s,r,v),N=(e,n,c,u=j,i=S)=>{const a=e?n:c;if(v[s]=Object.assign({type:e?u:i,message:a,ref:t},C(e?u:i,a)),!r)return v};if(i&&(!p&&!x&&(B||f(c))||ue(c)&&!c||x&&!Y(u).isValid||p&&!G(u).isValid)){const{value:e,message:n}=ie(i)?{value:!!i,message:i}:ce(i);if(e&&(v[s]=Object.assign({type:V,message:n,ref:w?b[s].options[0].ref:t},C(V,n)),!r))return v}if(!f(l)||!f(d)){let e,s;const{value:u,message:i}=ce(d),{value:a,message:o}=ce(l);if("number"===n||!n&&!isNaN(c)){const r=t.valueAsNumber||parseFloat(c);f(u)||(e=r>u),f(a)||(s=r<a)}else{const r=t.valueAsDate||new Date(c);ee(u)&&(e=r>new Date(u)),ee(a)&&(s=r<new Date(a))}if((e||s)&&(N(!!e,i,o,O,y),!r))return v}if(ee(c)&&!B&&(a||o)){const{value:e,message:t}=ce(a),{value:n,message:s}=ce(o),u=c.toString().length,i=!f(e)&&u>e,l=!f(n)&&u<n;if((i||l)&&(N(!!i,t,s),!r))return v}if(g&&!B){const{value:e,message:n}=ce(g);if(ne(e)&&!e.test(c)&&(v[s]=Object.assign({type:R,message:n,ref:t},C(R,n)),!r))return v}if(h){const e=Z(b,t),n=w&&u?u[0].ref:t;if(se(h)){const t=ae(await h(e),n);if(t&&(v[s]=Object.assign(Object.assign({},t),C(E,t.message)),!r))return v}else if(m(h)){let t={};for(const[c,u]of Object.entries(h)){if(!T(t)&&!r)break;const i=ae(await u(e),n,c);i&&(t=Object.assign(Object.assign({},i),C(c,i.message)),r&&(v[s]=t))}if(!T(t)&&(v[s]=Object.assign({ref:n},t),!r))return v}}return v};const fe=(e,r)=>d(e.inner)?e.inner.reduce((e,{path:t,message:n,type:c})=>Object.assign(Object.assign({},e),e[t]&&r?{[t]:oe(t,r,e,c,n)}:{[t]:e[t]||Object.assign({message:n,type:c},r?{types:{[c]:n||!0}}:{})}),{}):{[e.path]:{message:e.message,type:e.type}};async function de(e,r,t,n,c){if(n)return n(t,c);try{return{values:await e.validate(t,{abortEarly:!1,context:c}),errors:{}}}catch(e){return{values:{},errors:L(fe(e,r))}}}var ge=(e,r,t)=>l(e[r])?$(e,r,t):e[r];var me=e=>f(e)||!g(e);const he=(e,r)=>{const t=(r,t,n)=>{const c=n?`${e}.${t}`:`${e}[${t}]`;return me(r)?c:he(c,r)};return d(r)?r.map((e,r)=>t(e,r)):Object.entries(r).map(([e,r])=>t(r,e,!0))};var be=(e,r)=>(function e(r){return r.reduce((r,t)=>r.concat(d(t)?e(t):t),[])})(he(e,r)),ve=(e,r,t,n)=>{let c;return t.add(r),T(e)?c=void 0:l(e[r])?(c=$(L(e),r),l(c)||be(r,c).forEach(e=>t.add(e))):(c=e[r],t.add(r)),l(c)?m(n)?ge(n,r):n:c},pe=({isOnChange:e,hasError:r,isBlurEvent:t,isOnSubmit:n,isReValidateOnSubmit:c,isOnBlur:s,isReValidateOnBlur:u,isSubmitted:i})=>e&&t||n&&c||n&&!i||s&&!t&&!r||u&&!t&&r||c&&i,Oe=(e,r)=>{const t=L(re(e));return r?$(t,r,t):t};function ye(e,r){let t=!1;if(!d(e)||!d(r)||e.length!==r.length)return!0;for(let n=0;n<e.length&&!t;n++){const c=e[n],s=r[n];if(l(s)||Object.keys(c).length!==Object.keys(s).length){t=!0;break}for(const e in c)if(c[e]!==s[e]){t=!0;break}}return t}const je=(e,r)=>e.startsWith(`${r}[`);var Se=(e,r)=>[...e].reduce((e,t)=>!!je(r,t)||e,!1),Re=e=>typeof FileList!==v&&e instanceof FileList;var Ve=e=>({isOnSubmit:!e||e===b.onSubmit,isOnBlur:e===b.onBlur,isOnChange:e===b.onChange});const{useRef:Ee,useState:xe,useCallback:we,useEffect:Be}=e;function Ce({mode:e=b.onSubmit,reValidateMode:r=b.onChange,validationSchema:t,validationResolver:n,validationContext:c,defaultValues:s={},submitFocusError:u=!0,validateCriteriaMode:i}={}){const a=Ee({}),o="all"===i,g=Ee({}),O=Ee({}),y=Ee({}),j=Ee(new Set),S=Ee(new Set),R=Ee(new Set),V=Ee(new Set),E=Ee(!0),x=Ee({}),w=Ee(s),B=Ee(!1),C=Ee(!1),N=Ee(!1),F=Ee(!1),U=Ee(0),I=Ee(!1),H=Ee(),G=Ee({}),_=Ee(c),Q=Ee(new Set),[,X]=xe(),{isOnBlur:Y,isOnSubmit:ne,isOnChange:ce}=Ee(Ve(e)).current,ie=typeof window===v,ae=!(!t&&!n),oe=typeof document!==v&&!ie&&!l(window.HTMLElement),fe=oe&&"Proxy"in window,he=Ee({dirty:!fe,dirtyFields:!fe,isSubmitted:ne,submitCount:!fe,touched:!fe,isSubmitting:!fe,isValid:!fe}),{isOnBlur:be,isOnSubmit:je}=Ee(Ve(r)).current,Ce=we(()=>{B.current||X({})},[]),Ne=we((e,r,t,n)=>{let c=t||function({errors:e,name:r,error:t,validFields:n,fieldsWithValidation:c}){const s=T(t),u=T(e),i=$(t,r),a=$(e,r);return!(s&&n.has(r)||a&&a.isManual)&&(!!(u!==s||!u&&!a||s&&c.has(r)&&!n.has(r))||i&&!te(a,i))}({errors:g.current,error:r,name:e,validFields:V.current,fieldsWithValidation:R.current});if(T(r)?((R.current.has(e)||ae)&&(V.current.add(e),c=c||$(g.current,e)),g.current=z(g.current,[e])):(V.current.delete(e),c=c||!$(g.current,e),k(g.current,e,r[e])),c&&!n)return Ce(),!0},[Ce,ae]),Fe=we((e,r)=>{const t=e.ref,n=e.options,{type:c}=t,s=oe&&h(t)&&f(r)?"":r;return M(t)&&n?n.forEach(({ref:e})=>e.checked=e.value===s):q(t)?K(s)||Re(s)?t.files=s:t.value=s:J(t)?[...t.options].forEach(e=>e.selected=s.includes(e.value)):W(t)&&n?n.length>1?n.forEach(({ref:e})=>e.checked=s.includes(e.value)):n[0].ref.checked=!!s:t.value=s,!!c},[oe]),ke=e=>{if(!a.current[e]||!he.current.dirty&&!he.current.dirtyFields)return!1;const r=Se(Q.current,e),t=S.current.size;let n=x.current[e]!==Z(a.current,a.current[e].ref);if(r){const r=e.substring(0,e.indexOf("["));n=ye(Oe(a.current,r),$(w.current,r))}const c=(r?F.current:S.current.has(e))!==n;return n?S.current.add(e):S.current.delete(e),F.current=r?n:!!S.current.size,he.current.dirty?c:t!==S.current.size},Le=we(e=>{if(ke(e)||!$(O.current,e)&&he.current.touched)return!!k(O.current,e,!0)},[]),$e=we((e,r,t)=>{const n=d(r);for(const c in r){const s=`${t||e}${n?`[${c}]`:`.${c}`}`;m(r[c])&&$e(e,r[c],s);const u=a.current[s];u&&(Fe(u,r[c]),Le(s))}},[Fe,Le]),Ae=we((e,r)=>{const t=a.current[e];if(t){Fe(t,r);const n=Le(e);if(ue(n))return n}else me(r)||$e(e,r)},[Le,Fe,$e]),De=we(async(e,r)=>{const t=a.current[e];if(!t)return!1;const n=await le(a,o,t);return Ne(e,n,!1,r),T(n)},[Ne,o]),Me=we(async e=>{const{errors:r}=await de(t,o,Oe(a.current),n,_.current),c=E.current;return E.current=T(r),d(e)?(e.forEach(e=>{const t=$(r,e);t?k(g.current,e,t):z(g.current,[e])}),Ce()):Ne(e,$(r,e)?{[e]:$(r,e)}:{},c!==E.current),T(g.current)},[Ce,Ne,o,n,t]),We=we(async e=>{const r=e||Object.keys(a.current);if(ae)return Me(r);if(d(r)){const e=await Promise.all(r.map(async e=>await De(e,!0)));return Ce(),e.every(Boolean)}return await De(r)},[Me,De,Ce,ae]),Pe=e=>C.current||j.current.has(e)||j.current.has((e.match(/\w+/)||[])[0]);function Te(e,r,t){let n=!1;const c=d(e);(c?e:[e]).forEach(e=>{const t=ee(e);n=!(!Ae(t?e:Object.keys(e)[0],t?r:Object.values(e)[0])&&!c)||Pe(e)}),(n||c)&&Ce(),(t||c&&r)&&We(c?void 0:e)}H.current=H.current?H.current:async({type:e,target:r})=>{const c=r?r.name:"",s=a.current,u=g.current,i=s[c],l=$(u,c);let f;if(!i)return;const d=e===p.BLUR,m=pe({hasError:!!l,isOnChange:ce,isBlurEvent:d,isOnSubmit:ne,isReValidateOnSubmit:je,isOnBlur:Y,isReValidateOnBlur:be,isSubmitted:N.current}),h=ke(c);let b=Pe(c)||h;if(d&&!$(O.current,c)&&he.current.touched&&(k(O.current,c,!0),b=!0),m)return b&&Ce();if(ae){const{errors:e}=await de(t,o,Oe(s),n,_.current),r=E.current;E.current=T(e),f=$(e,c)?{[c]:$(e,c)}:{},r!==E.current&&(b=!0)}else f=await le(a,o,i);!Ne(c,f)&&b&&Ce()};const Ue=we((e={})=>{const r=T(w.current)?re(a.current):w.current;de(t,o,L(Object.assign(Object.assign({},r),e)),n,_.current).then(({errors:e})=>{const r=E.current;E.current=T(e),r!==E.current&&Ce()})},[Ce,o,n]),Ie=(e,r)=>{!l(H.current)&&e&&function(e,r,t,n){if(!t)return;const{ref:c,ref:{name:s,type:u},mutationWatcher:i}=t;if(!u)return void delete e[s];const a=e[s];if((M(c)||W(c))&&a){const{options:t}=a;d(t)&&t.length?(t.filter(Boolean).forEach(({ref:e,mutationWatcher:c},s)=>{(e&&P(e)||n)&&(D(e,r),c&&c.disconnect(),z(t,[`[${s}]`]))}),t&&!t.filter(Boolean).length&&delete e[s]):delete e[s]}else(P(c)||n)&&(D(c,r),i&&i.disconnect(),delete e[s])}(a.current,H.current,e,r)},ze=we((e,r)=>{if(!e||e&&Se(Q.current,e.ref.name)&&!r)return;Ie(e,r);const{name:t}=e.ref;g.current=z(g.current,[t]),O.current=z(O.current,[t]),x.current=z(x.current,[t]),[S,R,V,j].forEach(e=>e.current.delete(t)),(he.current.isValid||he.current.touched)&&(Ce(),ae&&Ue())},[Ce,ae,Ue]);const He=({name:e,type:r,types:t,message:n,preventRender:c})=>{const s=a.current[e];te(g.current[e],{type:r,message:n,types:t})||(k(g.current,e,{type:r,types:t,message:n,ref:s?s.ref:{},isManual:!0}),c||Ce())};function Ge(e){T(a.current)||(d(e)?e:[e]).forEach(e=>ze(a.current[e],!0))}function _e(e,r={}){if(!e.name)return console.warn("Missing name @",e);const{name:t,type:n,value:c}=e,s=Object.assign({ref:e},r),u=a.current,i=M(e)||W(e);let f,g=u[t],m=!0,b=!1;if(i?g&&d(g.options)&&g.options.filter(Boolean).find(({ref:e})=>c===e.value):g)return void(u[t]=Object.assign(Object.assign({},g),r));if(n){const c=function(e,r){const t=new MutationObserver(()=>{P(e)&&(t.disconnect(),r())});return t.observe(window.document,{childList:!0,subtree:!0}),t}(e,()=>ze(s));g=i?Object.assign({options:[...g&&g.options||[],{ref:e,mutationWatcher:c}],ref:{type:n,name:t}},r):Object.assign(Object.assign({},s),{mutationWatcher:c})}else g=s;if(u[t]=g,T(w.current)||(f=ge(w.current,t),m=l(f),b=Se(Q.current,t),m||b||Fe(g,f)),ae&&!b&&he.current.isValid?Ue():T(r)||(R.current.add(t),!ne&&he.current.isValid&&le(a,o,g).then(e=>{const r=E.current;T(e)?V.current.add(t):E.current=!1,r!==E.current&&Ce()})),x.current[t]||b&&m||(x.current[t]=m?Z(u,g.ref):f),!n)return;!function({field:e,handleChange:r,isRadioOrCheckbox:t}){const{ref:n}=e;h(n)&&n.addEventListener&&r&&(n.addEventListener(t?p.CHANGE:p.INPUT,r),n.addEventListener(p.BLUR,r))}({field:i&&g.options?g.options[g.options.length-1]:g,isRadioOrCheckbox:i,handleChange:H.current})}function qe(e,r){if(!ie)if(ee(e))_e({name:e},r);else{if(!(m(e)&&"name"in e))return r=>r&&_e(r,e);_e(e,r)}}const Je=we(e=>async r=>{r&&(r.preventDefault(),r.persist());let c={},s={};const i=a.current;he.current.isSubmitting&&(I.current=!0,Ce());try{if(ae){s=re(i);const{errors:e,values:r}=await de(t,o,L(s),n,_.current);g.current=e,c=e,s=r}else for(const e of Object.values(i))if(e){const{ref:r,ref:{name:t}}=e,n=await le(a,o,e);n[t]?(k(c,t,n[t]),V.current.delete(t)):(R.current.has(t)&&V.current.add(t),s[t]=Z(i,r))}T(c)?(g.current={},await e(L(s),r)):(u&&oe&&A(i,c),g.current=c)}finally{N.current=!0,I.current=!1,U.current=U.current+1,Ce()}},[oe,Ce,ae,u,o,n,t]),Ke=e=>{const r=re(a.current),t=T(r)?w.current:r;return e&&e.nest?L(t):t};Be(()=>()=>{B.current=!0,a.current&&"production"===process.env.NODE_ENV&&Object.values(a.current).forEach(e=>ze(e,!0))},[ze]),ae||(E.current=V.current.size>=R.current.size&&T(g.current));const Qe={dirty:F.current,dirtyFields:S.current,isSubmitted:N.current,submitCount:U.current,touched:O.current,isSubmitting:I.current,isValid:ne?N.current&&T(g.current):E.current};return{watch:function(e,r){const t=F.current?{}:l(r)?l(w.current)?{}:w.current:r,n=re(a.current,e),c=j.current;if(T(t)||(he.current.dirty=!0),ee(e))return ve(n,e,c,t);if(d(e))return e.reduce((e,r)=>Object.assign(Object.assign({},e),{[r]:ve(n,r,c,t)}),{});C.current=!0;const s=!T(n)&&n||t;return e&&e.nest?L(s):s},control:Object.assign(Object.assign(Object.assign({register:qe,unregister:Ge,removeFieldEventListener:Ie,getValues:Ke,setValue:Te,reRender:Ce,triggerValidation:We},ae?{validateSchemaIsValid:Ue}:{}),C.current?{}:{watchFieldsRef:j}),{formState:Qe,mode:{isOnBlur:Y,isOnSubmit:ne,isOnChange:ce},reValidateMode:{isReValidateOnBlur:be,isReValidateOnSubmit:je},errorsRef:g,touchedFieldsRef:O,fieldsRef:a,resetFieldArrayFunctionRef:G,fieldArrayDefaultValues:y,validFieldsRef:V,dirtyFieldsRef:S,fieldsWithValidationRef:R,fieldArrayNamesRef:Q,isDirtyRef:F,readFormStateRef:he,defaultValuesRef:w}),handleSubmit:Je,setValue:we(Te,[Ce,Ae,We]),triggerValidation:We,getValues:we(Ke,[]),reset:we((e,r={})=>{if(oe)for(const e of Object.values(a.current))if(e&&h(e.ref)&&e.ref.closest)try{e.ref.closest("form").reset();break}catch(e){}e&&(w.current=e),Object.values(G.current).forEach(e=>se(e)&&e()),(({errors:e,dirty:r,isSubmitted:t,touched:n,isValid:c,submitCount:s})=>{a.current={},e||(g.current={}),n||(O.current={}),c||(V.current=new Set,R.current=new Set,E.current=!0),r||(S.current=new Set,F.current=!1),t||(N.current=!1),s||(U.current=0),x.current={},j.current=new Set,C.current=!1})(r),Ce()},[]),register:we(qe,[w.current,x.current]),unregister:we(Ge,[]),clearError:we(function(e){l(e)?g.current={}:z(g.current,d(e)?e:[e]),Ce()},[]),setError:we(function(e,r="",t){ee(e)?He(Object.assign({name:e},m(r)?{types:r,type:""}:{type:r,message:t})):d(e)&&(e.forEach(e=>He(Object.assign(Object.assign({},e),{preventRender:!0}))),Ce())},[]),errors:g.current,formState:fe?new Proxy(Qe,{get:(e,r)=>r in e?(he.current[r]=!0,e[r]):{}}):Qe}}function Ne(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(n=Object.getOwnPropertySymbols(e);c<n.length;c++)r.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(e,n[c])&&(t[n[c]]=e[n[c]])}return t}const Fe=t(null);function ke(){return n(Fe)}function Le(e){var{children:r,formState:t,errors:n}=e,s=Ne(e,["children","formState","errors"]);return c(Fe.Provider,{value:Object.assign(Object.assign({},s),{formState:t,errors:n})},r)}var $e=()=>{const e=typeof performance===v?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const t=(16*Math.random()+e)%16|0;return("x"==r?t:3&t|8).toString(16)})};const Ae=(e,r)=>Object.assign({[r]:$e()},m(e)?e:{value:e}),De=(e,r)=>(d(e)?e:[]).map(e=>Ae(e,r));var Me=(e,r)=>l(r)?[]:d(r)?function(e,r){let t=-1;for(;++t<e.length;)r.indexOf(t)>=0&&delete e[t];return e.filter(Boolean)}(e,r):((e,r)=>[...e.slice(0,r),...e.slice(r+1)])(e,r),We=(e,r,t)=>d(e)?e.splice(t,0,e.splice(r,1)[0]):[],Pe=(e,r,t)=>{if(d(e)){const n=[e[t],e[r]];e[r]=n[0],e[t]=n[1]}},Te=(e,r)=>[...d(r)?r:[r||null],...e],Ue=(e,r,t)=>[...e.slice(0,r),...d(t)?t:[t||null],...e.slice(r)],Ie=e=>d(e)?Array(e.length).fill(null):void 0;const{useEffect:ze,useCallback:He,useRef:Ge,useState:_e}=e,qe=({control:e,name:r,keyName:t="id"})=>{const n=ke(),{resetFieldArrayFunctionRef:c,fieldArrayNamesRef:s,reRender:u,fieldsRef:i,getValues:a,defaultValuesRef:o,removeFieldEventListener:f,errorsRef:g,dirtyFieldsRef:m,isDirtyRef:h,touchedFieldsRef:b,readFormStateRef:v,watchFieldsRef:p,validFieldsRef:O,fieldsWithValidationRef:y,fieldArrayDefaultValues:j,validateSchemaIsValid:S}=e||n.control,R=Ge(j.current[r]||[...$(o.current,r,[])]),V=N(r),[E,x]=_e(De(R.current,t)),[w,B]=_e(!1),C=Ge(E);C.current=E,V&&(j.current[r]=R.current);const F=e=>e.map(e=>Ae(e,t)),k=e=>{x(e),v.current.isValid&&S&&S({[r]:e})},L=e=>{v.current.dirty&&(h.current=!!l(e)||ye(e,o.current[r]));for(const e in i.current)je(e,r)&&i.current[e]&&f(i.current[e],!0)},A=()=>{const e=a({nest:!0})[r];if(d(e))for(let r=0;r<e.length;r++)C.current[r]=Object.assign(Object.assign({},C.current[r]),e[r])},D=()=>{L(),R.current=$(o.current,r,[]),x(De(R.current,t))};return ze(()=>{V&&w&&E.length<j.current[r].length&&j.current[r].pop()},[E,r,j,w,V]),ze(()=>{if(p)for(const e of p.current)if(e.startsWith(r)){u();break}u()},[E,r,u,p]),ze(()=>{const e=c.current,t=s.current;return t.add(r),e[r]=D,()=>{L(),delete e[r],t.delete(r)}},[]),{swap:He((e,t)=>{A();const n=Oe(i.current,r);Pe(n,e,t),L(n),Pe(C.current,e,t),k([...C.current]),g.current[r]&&Pe(g.current[r],e,t),v.current.touched&&b.current[r]&&(Pe(b.current[r],e,t),u())},[]),move:He((e,t)=>{A();const n=Oe(i.current,r);We(n,e,t),L(n),We(C.current,e,t),k([...C.current]),g.current[r]&&We(g.current[r],e,t),v.current.touched&&b.current[r]&&(We(b.current[r],e,t),u())},[]),prepend:He(e=>{L(),k(Te(C.current,d(e)?F(e):[Ae(e,t)])),g.current[r]&&(g.current[r]=Te(g.current[r],Ie(e))),v.current.touched&&b.current[r]&&(b.current[r]=Te(b.current[r],Ie(e)),u())},[]),append:He(e=>{v.current.dirty&&(h.current=!0,u()),k([...C.current,...d(e)?F(e):[Ae(e,t)]])},[]),remove:He(e=>{let t=!1;if(l(e)||A(),L(Me(Oe(i.current,r),e)),k(Me(C.current,e)),B(!0),g.current[r]&&(g.current[r]=Me(g.current[r],e),g.current[r].filter(Boolean).length||delete g.current[r]),v.current.touched&&b.current[r]&&(b.current[r]=Me(b.current[r],e),t=!0),v.current.dirty&&(m.current.forEach(t=>{(l(r)||t.startsWith(`${r}[${e}]`))&&m.current.delete(t)}),t=!0),v.current.isValid&&!S){let n=-1,c=!1;const s=l(e);for(;n++<E.length;){const t=n===E.length-1,u=(d(e)?e:[e]).indexOf(n)>=0;if((u||s)&&(c=!0),c)for(const e in E[n]){const c=`${r}[${n}].${e}`;if(u||t||s)O.current.delete(c),y.current.delete(c);else{const t=`${r}[${n-1}].${e}`;O.current.has(c)&&O.current.add(t),y.current.has(c)&&y.current.add(t)}}}t=!0}t&&u()},[E]),insert:He((e,n)=>{A(),L(Ue(Oe(i.current,r),e)),k(Ue(C.current,e,d(n)?F(n):[Ae(n,t)])),g.current[r]&&(g.current[r]=Ue(g.current[r],e,Ie(n))),v.current.touched&&b.current[r]&&(b.current[r]=Ue(b.current[r],e,Ie(n)),u())},[]),fields:E}};const Je=e=>{var{name:t,rules:n,as:o,onBlur:f,onChange:d,onChangeName:g=b.onChange,onBlurName:h=b.onBlur,valueName:v,defaultValue:p,control:O,onFocus:y}=e,j=Ne(e,["name","rules","as","onBlur","onChange","onChangeName","onBlurName","valueName","defaultValue","control","onFocus"]);const S=ke(),{defaultValuesRef:R,setValue:V,register:E,unregister:x,errorsRef:w,removeFieldEventListener:B,triggerValidation:C,mode:{isOnSubmit:N,isOnBlur:F,isOnChange:k},reValidateMode:{isReValidateOnBlur:L,isReValidateOnSubmit:A},formState:{isSubmitted:D},fieldsRef:M,fieldArrayNamesRef:W}=O||S.control,[P,T]=s(l(p)?$(R.current,t):p),U=u(P),I=ue(P),z=()=>!pe({hasError:!!$(w.current,t),isOnBlur:F,isOnSubmit:N,isOnChange:k,isReValidateOnBlur:L,isReValidateOnSubmit:A,isSubmitted:D}),H=e=>{const r=((e,r)=>me(e)||!m(e.target)||m(e.target)&&!e.type?e:r||l(e.target.value)?e.target.checked:e.target.value)(e,I);return T(r),U.current=r,r},G=()=>{Se(W.current,t)&&M.current[t]&&B(M.current[t],!0),E(Object.defineProperty({name:t,focus:y},"value",{set(e){T(e),U.current=e},get:()=>U.current}),Object.assign({},n))};i(()=>{M.current[t]||(G(),T(l(p)?$(R.current,t):p))}),i(()=>(G(),()=>{Se(W.current,t)||x(t)}),[t]),i(()=>{G()},[n]);const _=F||L,q=Object.assign(Object.assign(Object.assign(Object.assign({name:t},j),d?{[g]:(e=>(...r)=>V(t,H(e(r)),z()))(d)}:{[g]:e=>{const r=H(e);V(t,r,z())}}),f||_?{[h]:(...e)=>{f&&f(e),_&&C(t)}}:{}),{[v||(I?"checked":"value")]:P});return r(o)?a(o,q):c(o,q)},Ke=e=>{var{as:t,errors:n,name:s,message:u,children:i}=e,l=Ne(e,["as","errors","name","message","children"]);const f=ke(),d=$(n||f.errors,s);if(!d)return null;const{message:g,types:m}=d,h=Object.assign(Object.assign({},t?l:{}),{children:i?i({message:g||u,messages:m}):g||u});return t?r(t)?a(t,h):c(t,h):c(o,Object.assign({},h))};export{Je as Controller,Ke as ErrorMessage,Le as FormContext,qe as useFieldArray,Ce as useForm,ke as useFormContext};
